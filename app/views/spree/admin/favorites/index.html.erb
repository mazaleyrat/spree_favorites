<%= render partial: 'spree/admin/users/sidebar', locals: { current: :favorites } %>

<% content_for :page_title do %>
  <%= link_to @user.email, spree.edit_admin_user_url(@user) %> /
  <%= Spree.t(:favorites, scope: :favorites) %>
<% end %>

<% if @favorites.present? %>
  <table id="favorites" class="table table-hover">
    <thead>
      <tr>
        <th><%= Spree.t(:thumbnail) %></th>
        <th><%= Spree.t(:name) %></th>
        <th><%= Spree.t(:status) %></th>
        <th><%= Spree.t(:created_at) %></th>
        <th><%= Spree.t(:price) %></th>
        <th class="actions"></th>
      </tr>
    </thead>
    <tbody id="wished_items">
      <% @favorites.each do |favorite|
          variant = favorite.variant
          product = variant.product %>
      <tr>
        <td style="text-align:center">
          <% if variant.images.length == 0 %>
            <%= mini_image(product) %>
          <% else %>
            <%= mini_image(variant) %>
          <% end %>
        </td>
        <td>
          <%= link_to product.try(:name), edit_admin_product_path(product) %>
        </td>
        <td>
          <%= variant.can_supply? ? Spree.t(:in_stock) : Spree.t(:out_of_stock) %>
        </td>
        <td>
          <%= favorite.created_at.strftime '%m/%d/%Y' %>
        </td>
        <td>
          <%= variant.display_price %>
        </td>
        <td class="actions actions-1 text-right">
          <%= link_to_delete favorite, url: admin_user_favorite_path(@user, favorite), no_text: true if can?(:delete, favorite) %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <div class="alert alert-info no-objects-found">
    <%= Spree.t(:no_favorites, scope: :favorites) %>
  </div>
<% end %>


<%= render 'spree/admin/users/lifetime_stats' %>
